# 云文档

## 介绍

一个简单的 Markdown、OpenAPI 文档服务器，支持 AI 辅助编辑功能

## 软件架构

- go1.22
- vue3
- sqlite/postgres

## 编译步骤

- 安装 go 环境
- 安装 nodejs 环境
- 进入目录，添加权限并执行 **build.bat** 或 **build.sh**
- 编译后的可执行文件在 **./md** 目录下

## 命令行参数

- `-p`：监听端口号。默认值：**9900**
- `-log`：日志目录，存放近 30 天的日志，设置为空则不生成日志文件。默认值：**./logs**
- `-data`：数据目录，存放数据库文件和图片。默认值：**./data**
- `-reg`：是否允许注册（即使禁止注册，在没有任何用户的情况时仍可注册）。默认值：**true**
- `-ai_key`：AI 配置加密密钥（16/24/32 字节），用于加密存储用户的 API Key。默认值：**空**
- `-pg_host`：postgres 主机地址
- `-pg_port`：postgres 端口
- `-pg_user`：postgres 用户
- `-pg_password`：postgres 密码
- `-pg_db`：postgres 数据库名

### 数据库选择

当 postgres 相关的 5 个命令行参数全部填写时，将使用 postgres 数据库，否则使用默认的 sqlite 数据库

## docker 镜像

- [https://hub.docker.com/r/streamerzero/md](https://hub.docker.com/r/streamerzero/md)

## AI 功能

支持接入 OpenAI API 兼容的大语言模型，提供 AI 对话辅助能力。

### 配置方式

点击右上角用户头像，选择「AI API 配置」进行设置：

- **基础配置**：填写 Base URL、API Key，选择模型
- **系统提示词**：管理多个系统提示词，可通过开关启用/禁用，支持切换使用
- **模式设置**：
  - 启用 AI 面板：在编辑器工具栏显示 AI 按钮
  - 允许读取当前文档：AI 可访问当前文档内容作为上下文
- **同步设置**：将配置同步到服务器，支持多设备使用

### 功能特性

- **AI 对话**：支持与 AI 进行多轮对话，可配合文档上下文使用
- **多对话记录**：支持创建、切换、搜索多个对话，对话自动保存到服务器
- **AI 自动命名**：新对话在首次 AI 回复后自动生成标题
- **复制回复**：每条 AI 回复旁边都有复制按钮，可一键复制内容
- **导出对话**：将当前会话导出为 JSON 文件，便于备份或分享
- **思考过程展示**：支持显示 AI 的推理过程（如 DeepSeek 等模型）

### 安全说明

- API Key 存储在浏览器本地，服务器端加密存储
- 前端直接调用 AI API，服务器不代理请求内容
- 同步到服务器的配置使用 AES 加密（需配置 `-ai_key` 参数）

## 隐含的功能按钮

- 编辑模式："云文档"标题
- 收缩边栏："云文档"标题左侧图标
- 发布链接：文档列表蓝色倒三角
- 公开文档列表：登录页"云文档"标题
